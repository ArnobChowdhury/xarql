$(document).ready(function(){function d(h){var l=decodeURIComponent(window.location.search.substring(1)),k=l.split("&"),m,j;for(j=0;j<k.length;j++){m=k[j].split("=");if(m[0]===h){return m[1]===undefined?true:m[1]}}}function g(){$(".status").each(function(){$(this).text("trying")});var h=$("<div></div>").load("http://xarql.com/polr/updt?id="+$("#main-post-id").text()+"&page="+$("#page").text()+"&sort="+$("#sort").text()+"&flow="+$("#flow").text()+"#full",function(j,i,k){if(i=="error"){$(".status").each(function(){$(this).text(k.statusText)})}else{$("#main-post").replaceWith(h.find("#main-post-container").html());$("#replies").replaceWith(h.find("#replies-container").html());$("title").text(h.find("#main-post-title").text()+" ~ xarql");c();$(".status").each(function(){$(this).text(k.statusText)})}})}var e=d("refresh");if(typeof e!="undefined"&&e==="true"){g();history.pushState("xarql","xarql",window.location.pathname)}$(".update-button").each(function(){var h=$(this);h.on("click",function(){g()})});$("#post-form").submit(function(k){k.preventDefault();$(".status").each(function(){$(this).text("trying")});var h=$(this),m=h.find("input[name='title']").val(),j=h.find("textarea[name='content']").val(),l=h.find("input[name='answers']").val(),i=h.attr("action");h.trigger("reset");$("#replying-to-input").val(parseInt($("#main-post-id").text()));$.ajax({type:"POST",url:i,data:{title:m,content:j,answers:l,}}).done(function(){$(".status").each(function(){$(this).text("success")})}).fail(function(){$(".status").each(function(){h.find("input[name='title']").val(m);h.find("textarea[name='content']").val(j);h.find("input[name='answers']").val(l);$(this).text("error")})}).always(function(){window.setTimeout(g,500)})});function f(){$(".status").each(function(){$(this).text("trying")});var i=$("#nav-form"),k=$("#page-dropdown").val(),j=$("#sort-dropdown").val(),h=$("#flow-dropdown").val();var l=$("<div></div>").load("http://xarql.com/polr/updt?id="+$("#main-post-id").text()+"&page="+k+"&sort="+j+"&flow="+h,function(n,m,o){if(m=="error"){$(".status").each(function(){$(this).text(o.statusText)})}else{$("#main-post").replaceWith(l.find("#main-post-container").html());$("#replies").replaceWith(l.find("#replies-container").html());$("title").text(l.find("#main-post-title").text()+" ~ xarql");history.pushState("xarql","xarql",window.location.pathname+"?page="+k+"&sort="+j+"&flow="+h);$("#page").text(k);$("#sort").text(j);$("#flow").text(h);c();if(k>0){$("#prev-form").show();$("#prev-form").css("display","inline")}else{$("#prev-form").hide()}if(k<9){$("#next-form").show();$("#next-form").css("display","inline")}else{$("#next-form").hide()}$(".status").each(function(){$(this).text(o.statusText)});$("html, body").animate({scrollTop:0},"fast")}})}$("#nav-form").submit(function(h){h.preventDefault();f()});$("#next-form").submit(function(h){h.preventDefault();var i=parseInt($("#page-dropdown").val());if(i<9){$("#page-dropdown").val(i+1)}f()});$("#prev-form").submit(function(h){h.preventDefault();var i=parseInt($("#page-dropdown").val());if(i>0){$("#page-dropdown").val(i-1)}f()});$("html").css("font-size",Cookies.get("font-size"));$("#text-up").on("click",function(){var h=parseFloat(window.getComputedStyle(document.getElementById("html")).fontSize);$("html").css("font-size",(h+1)+"px");Cookies.set("font-size",(h+1)+"px")});$("#text-dn").on("click",function(){var h=parseFloat(window.getComputedStyle(document.getElementById("html")).fontSize);$("html").css("font-size",(h-1)+"px");Cookies.set("font-size",(h-1)+"px")});function a(i){$(".status").each(function(){$(this).text("trying")});var h=$("<div></div>").load("http://xarql.com/polr/updt?id="+i+"&page=0",function(k,j,l){if(j=="error"){$(".status").each(function(){$(this).text(l.statusText)})}else{$("#main-post").replaceWith(h.find("#main-post-container").html());$("#replies").replaceWith(h.find("#replies-container").html());$("title").text(h.find("#main-post-title").text()+" ~ xarql");history.pushState("xarql","xarql","http://xarql.com/polr/"+i);$(".status").each(function(){$(this).text(l.statusText)});$("html, body").animate({scrollTop:0},"fast");$("#replying-to-input").val(parseInt($("#main-post-id").text()));$("#page-dropdown").val(0);$("#prev-form").hide();$("#next-form").show();$("#next-form").css("display","inline");c()}})}function c(){$(".view-link").each(function(){$(this).unbind("click");$(this).on("click",function(){var h=$(this).attr("post-id");a(h);return false})})}c();function b(h){if(h==="light"){$("p").css("font-weight","lighter");$(".bold").css("font-weight","normal");$("#font-light-button").hide();$("#font-normal-button").show();Cookies.set("font-weight","light")}else{$("p").css("font-weight","normal");$(".bold").css("font-weight","bold");$("#font-normal-button").hide();$("#font-light-button").show();Cookies.set("font-weight","normal")}}b(Cookies.get("font-weight"));$("#font-light-button").on("click",function(){b("light")});$("#font-normal-button").on("click",function(){b("normal")});$(".ajax-bar").each(function(){$(this).show()});$("#option-pane-open-button").on("click",function(){$("#option-pane").show();$("#option-pane-close-button").show();$(this).hide()});$("#option-pane-close-button").on("click",function(){$("#option-pane").hide();$("#option-pane-open-button").show();$(this).hide()})});